/** Copyright (c) 2013-2014 Mandarinazul
 * Author: Julian Acosta
 * Licence: http://opensource.org/licenses/MIT
 * Version: 1.0
 */

(function(e){e.fn.aspectRatioResizeImg=function(t){var n=e.extend({backgroundHorizontalAlign:"CENTER",backgroundVerticalAlign:"MIDDLE",resizeContainerType:null,debug:false,callback:null,imageClass:null,mode:"FILL"},t);return this.each(function(){function o(){i=t.width()/t.height();s=r.attr("width")/r.attr("height");l()}function u(){if(n.resizeContainerType==="WIDTH"){var e=t.height()*s;if(t.css("box-sizing")==="border-box"){e+=parseInt(t.css("padding-left"));e+=parseInt(t.css("padding-right"));e+=parseInt(t.css("border-left-width"));e+=parseInt(t.css("border-right-width"))}t.css("width",e)}else{if(n.resizeContainerType==="HEIGHT"){var r=t.width()/s;if(t.css("box-sizing")==="border-box"){r+=parseInt(t.css("padding-top"));r+=parseInt(t.css("padding-bottom"));r+=parseInt(t.css("border-top-width"));r+=parseInt(t.css("border-bottom-width"))}t.css("height",r)}}c()}function a(){var e=i>s?true:false;if(n.mode==="FILL"){if(e){r.attr("width",t.width());r.attr("height",r.attr("width")/s)}else{r.attr("height",t.height());r.attr("width",r.attr("height")*s)}}else if(n.mode==="FIT"){if(e){r.attr("height",t.height());r.attr("width",r.attr("height")*s);console.log("a")}else{console.log("b");r.attr("width",t.width());r.attr("height",r.attr("width")/s)}}else if(n.mode==="STRETCH"){r.attr("width",t.width());r.attr("height",t.height())}h()}function f(){var e=t.height();var i=r.height();var s=i-e;var o=t.width();var u=r.width();var a=u-o;if(n.mode==="CENTER"){r.css("marginLeft",-a/2);r.css("marginTop",-s/2)}else if(n.mode==="VERTICAL_CENTER"){r.css("marginTop",-s/2);if(n.backgroundHorizontalAlign==="LEFT"){r.css("marginLeft",0)}else if(n.backgroundHorizontalAlign==="CENTER"){r.css("marginLeft",-a/2)}else if(n.backgroundHorizontalAlign==="RIGHT"){r.css("marginLeft",-a)}}else{if(n.backgroundHorizontalAlign==="LEFT"){r.css("marginLeft",0)}else if(n.backgroundHorizontalAlign==="CENTER"){r.css("marginLeft",-a/2)}else if(n.backgroundHorizontalAlign==="RIGHT"){r.css("marginLeft",-a)}else{r.css("marginLeft",n.backgroundHorizontalAlign)}if(n.backgroundVerticalAlign==="TOP"){r.css("marginTop",0)}else if(n.backgroundVerticalAlign==="MIDDLE"){r.css("marginTop",-s/2)}else if(n.backgroundVerticalAlign==="BOTTOM"){r.css("marginTop",-s)}else{r.css("marginTop",n.backgroundVerticalAlign)}p()}}function l(){if(n.debug){console.log("Container AR :"+i);console.log("Img AR :"+s)}}function c(){if(n.debug){console.log("Container WIDTH :"+t.width());console.log("Container HEIGHT :"+t.height())}}function h(){if(n.debug){console.log("IMG CLASS:"+r.attr("class"))}}function p(){if(n.debug){}}var t=e(this);if(n.imageClass){var r=t.find("img."+n.imageClass)}else{var r=t.find("img")}r.css("display","block");var i;var s;o();u();o();a();f();if(n.callback){n.callback()}})}})(jQuery)